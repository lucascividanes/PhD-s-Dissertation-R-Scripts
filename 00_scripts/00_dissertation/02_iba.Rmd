---
output: pdf_document
---

# The use(s) of individual budget amendaments

## Introduction

This second chapter moves in the direction of uncovering mechanisms to foster territorialization to answer: *how discretionary funds can be used for electoral purposes?* The debate about individual budget amendments (IBAs) is a long and contested one in Political Science in Brazil. Yet very little attention was devoted to understanding how IBAs were used through the legislator’s perspective. Notwithstanding how far the pork hypothesis was stretched, I aim at showing that, if that instrument is essentially a distributive one, pork may still be only one strategy of use of IBAs. Indeed, the employment of those discretionary funds may play a manyfold function in nonprogrammatic politics.

The academic debate centered on the use of individual budget amendments (IBAs) in Brazil -- an annual budget quota over legislators’ individual discretion -- has been a fruitful and divisive one among political scientists in the last decades. Seminal models -- *distributivist* and *partisan* -- used to interpret the Executive-Legislative relationship inaugurated by the 1988 Constitution diverged on the understanding of the role played by that instrument in the organization of the political system [@ames_deadlock_2001; @figueiredo_executivo_2001]. Studies that sought to find a middle-ground solution [@carvalho_e_2003; @pereira_partidos_2003] helped to stress the concept of electoral connection [@mayhew_congress_2004] in the debate, highlighting how the multitude of interests and strategies composing the Brazilian Congress could explain the relative reliance on IBAs as a mechanism of credit claiming.

The focus on the governability aspect at the federal level, however, has overshadowed a debate about how the use(s) of IBAs do take place in other levels of government and how the employment of those resources themselves can play a manyfold function through the eyes of a legislator. Building on the contribution of Stokes et al. [-@stokes_brokers_2013] on nonprogrammatic politics -- and its further developments by Bussell [-@bussell_clients_2019] --, I will suggest three main functions that the use of IBAs may fulfill -- a pork barrel and a clientelist one; and a constituency service alternative -- to empirically assess the determinants favoring the reliance on each one of them at the local level. Finally, a novelty envisioned by this chapter is to use the case studies of large Brazilian municipalities (mobilizing a relevant volume of resources in terms of IBAs) to make a first exploratory move to uncover the use(s) of IBAs at the local level.

Next, I present the theoretical background supporting the main hypotheses of this chapter, then, I turn to the methods used to operationalize the envisioned tests and, finally, I show the preliminary results and discuss them in the following sections.

## Theoretical background

For long, the role played by IBAs in the organization of the Brazilian political system has been over dispute. At the center of the distributivist/partisan controversy was, ultimately, two axiological interpretations of the institutions orienting the executive-legislative relationship in Brazil. On the one hand, a pessimistic one, picturing a weak executive in need of coping with an incredible number of party labels and interests, recurring to IBAs as a quid pro quo to reach some control over the legislative agenda in the so-called coalition(‘s) presidentialism [@abranches_presidencialismo_1988]. On the other hand, a conversely positive one, that, on stressing the concentration of resources on a few key players in the congress and the legislative powers on the president’s hands, underplayed the bargain’s latitude of the ordinary legislator.

IBAs, therefore, would range from pivotal instruments for governability [@ames_deadlock_2001] to mere extensions of the Executive power [@limongi_processo_2005] -- able to be “steered” for the government purposes -- according to the observer’s bias, leaving many unconclusive arguments [@vasselai_o_2014].

In turn, synthetical propositions sought to explain how the empirical juxtaposition of both models was possible. First, it should be considered that in open-list proportional representation (OLPR) electoral systems, like the Brazilian one, Legislative houses would be composed by multiple configurations of electoral connection that, in accordance with their (spatial) voting patterns, would face different incentives constraining their legislative behavior. Therefore, not only vertical and horizontal dimensions of concentration of votes [@ames_deadlock_2001], for instance, matters, but also the characteristics of a given (geographical) constituency that would both push for the more or less reliance on pork practices as predicted by the distributivist-side of the IBAs functional interpretation [@carvalho_e_2003]. Accordingly, if the concentration of resources in the Legislative arena favored the party discipline -- a keystone in Figueiredo and Limongi’s [-@figueiredo_executivo_2001] argument --, it was also the best strategy for backbenchers to reach access to resources for their political reproduction in the much-decentralized electoral arena [@pereira_partidos_2003].

In short, IBAs were, indeed, a positive-sum game, enriching, at the same time, the Executive’s power to bargain and the ordinary legislators’ electoral fate.

Not mentioning how those models got fuzzier in more recent years [@freitas_neoconstitucionalismo_2018], the focus on the governability aspect of the federal government left behind analyses centered on the use(s) of IBAs themselves. Indeed, so far, only one function that I want to emphasize here has been properly stressed by the mainstream literature, namely, the *pork barrel* one [@ames_deadlock_2001; @pereira_partidos_2003; @pereira_successful_2003; @pereira_o_2007; @bertholini_pork_2018] -- and, not rarely, employed interchangeably with the notion of clientelism. Put simply, in this way of reasoning, politicians would tend to direct IBAs for those who voted for them (not individually), i.e., based on their past electoral outcomes. Yet, even though, more recent contributions already documented other functions possibly attached to that instrument [@mesquita_emendas_2008; @silva_uma_2009; @barone_eleicoes_2014; @mesquita_emendas_2014; @baiao_emendas_2016], little effort has been done so far to systematize such a knowledge and to place it in the broader literature of nonprogrammatic politics. Therefore, I use Bussell’s [-@bussell_clients_2019] conceptualization for the distribution of benefits in patronage democracies -- built over the seminal contribution of Stokes et al. [-@stokes_brokers_2013] -- to complexify this repertoire of use(s) of IBAs suggesting two other functions that they very often fulfill: a proper *clientelist* one and a *constituency service* counterpart.

Following the scheme in \autoref{typology}, the idea of contingency -- i.e., the targeting of benefits based on political support -- would divide nonprogrammatic politics in: partisan distribution (yes); and constituency service (no). The former would still be derived in two main functions regarding the use of those benefits as a quid pro quo for political support: clientelism (yes); and partisan bias (no).

I place the most common understanding of the use of IBAs by the mainstream literature in the partisan bias basket of the proposed typology. In short, legislators would use IBAs as pork barrel to distribute (particularized) benefits (not individually) targeting their own “electoral strongholds”. Yet in the same branch, a much more specific use of that instrument would be the use of IBAs as clientelism. In this case, a whole set of criteria, basically involving principal/agent relationships and mechanisms to enforce the so-called “perverse accountability” [@stokes_brokers_2013], would need to be met to properly fulfill the quid pro quo condition connecting benefits and votes. Finally, as argued by Bussell [-@bussell_clients_2019], a much more strategic role can be attached to the distribution of those benefits envisioning the expansion of the electoral support of a given politician. In this sense, the use of IBAs as constituency service “can provide a potent means for politicians to target these excluded voters, who are likely to be swing voters or, depending on local electoral dynamics, co-partisans of more senior politicians” [@bussell_clients_2019, p. 11]. Such a list is hardly exhaustive and should be thought of as ideal functional types that may accommodate a distinct set of mechanisms of the nonprogrammatic distribution repertoire regarding the use(s) of IBAs in Brazil.

![Conceptualizing the use of IBAs in nonprogrammatic politics. Source: author, adapted from Bussell (2019, p. 20). \label{typology}](00_dissertation/figures/bussell.pdf)

Besides, the excessive attention devoted by most scholars to the federal institutions eclipsed a more systematic analysis about how the use(s) of IBAs do take place at other levels of government. Particularly, in large municipalities -- where legislators’ discretionary funds reach comparable (and even higher) volumes of resources when compared to their federative counterparts.

For instance, in 2024, a local legislator in the municipality of São Paulo had direct influence over circa R$5 million in IBAs, a regional legislator of the state of São Paulo of about R$10 million and a federal legislator of São Paulo of approximately R$40 million. The median number of votes that an elected representative receives in each jurisdiction, respectively, is about 30 thousand for the city councilor, 100 thousand for the state deputy and 150 thousand for the federal deputy. Hence, a rate of about R$200 per voter at the local level, R$100 at the regional level and R$300 at the federal one in a year basis -- this last figure used to be half of that size until 2022 but has barely doubled in 2023, following the executive-legislative disputes over the federal budget in recent years.

Most importantly, I advocate for a more realistic approach in the analysis of the use(s) of IBAs. The path from the approval of a specific rubric in the annual budgetary law until its proper execution can be a very erratic one and much less rational than most narratives suggest. If the territorial connection is a top concern of most legislators in their representative task [@carvalho_e_2003; @nicolau_o_2006; @roeder_selecao_2017], there are many constraints that ultimately influences their actual choices [@gomes_role_2020; @hoyler_representacao_2022]. Legislation, state capacity, brokerage, geography, to cite a few, are all relevant variables in this process. In what we can call the “political economy” of the use(s) of IBAs, indeed, we are referring to the culmination of this intricated calculation of representation itself and the search to root political action through specific mechanisms that can overcome informational gaps [@silva_o_2020].

For instance, Baião et al. [-@baiao_quem_2019] formalizes at least three of those mechanisms: a proper pork barrel one based on the credit claiming of the deliverance of distributive goods; a second patronage one based on the financing of private entities, having (il)legal campaign donations as its main quid pro quo; and a third brokerage one that relies on political support based on the financing of key territorial players, such as mayors, that I extend to brokers in a wider sense [@holland_beyond_2015; @bueno_bypassing_2018; @hoyler_representacao_2022]. All those mechanisms can be associated with some of the functions stressed before. But, still, we are almost never associating it with the noncontingent use of IBAs. Therefore, my first hypothesis states that:

*H1: Contingent and noncontingent functions compose a relevant part of the use(s) of IBAs repertoire at the local level.*

Moreover, the reliance on each function might not be equally distributed. Following Marques [-@marques_electoral_2018], I aim at testing how the use(s) of IBAs interacts with the spatial voting patterns of city councilors and the characteristics of the territories they are associated with. The multiple configurations of electoral connection in OLPR in large multi-member districts create very distinct incentives to the reliance on nonprogrammatic politics. Studying the use of IBAs in the municipality of Rio de Janeiro, Marques have confirmed that the more (vertically and horizontally) concentrated the voting patterns of a city councilor, the greater the amount of IBAs funds she contingently targets to her electoral strongholds. Besides, the lower the level of development of those territories, the higher the amount of resources targeted via IBAs. Hence, I aim at testing the generalization of two derivative hypotheses:

*H1a: Incumbents with more concentrated voting patterns will target more funds in contingent and noncontingent functions.*

*H1b: Incumbents with constituencies in less developed territories will target more funds in contingent and noncontingent functions.*

## Methods

To test the hypotheses formulated above, one of the greatest methodological challenges concerns the definition of an electoral territory for proportional representatives in Brazil. As electoral districts in that country are defined at-large, i.e., it comprehends the whole municipality in the case of city councilors -- or the whole state for deputies --, to determine a spatial unit of analysis -- essential to characterize the use(s) of IBAs in nonprogrammatic politics -- is not a trivial task.

The option in this study was to follow past contributions that faced the same issue with a few adaptations. In this sense, the electoral territory was defined essentially as the territories where Local Indicator of Spatial Correlation (LISA) maps of the electoral outcomes for each legislator was classified as “high-high” or “high-low” [@terron_ha_2012; @silva_rebatizando_2013] plus those classified in the fifth class (or higher) of a standard deviation map [@gomes_role_2020].

The contingent use is operationalized by the targeting of IBAs to electoral territories in moment t, while the noncontingent use is operationalized by the targeting of IBAs to new electoral territories in moment t + 4. IBAs targeted to other territories are operationalized as nonterritorial.

Moreover, to test how the incentives coming from the electoral arena may affect the reliance on contingent and noncontingent functions, the locational quotient (LQ) indicator was calculated for every city councilor in each specific spatial unit of analysis. The LQ is the ratio between two proportions: the proportion of votes obtained in the spatial unit in relation to the candidate’s total vote; and the proportion of voters in the spatial unit in the municipality’s electorate, i.e., the expected share of votes of the candidate in that spatial unit [@avelino_concentracao_2016].

Besides, a classification based on the vertical and horizontal spatial voting patterns of each legislator, as seminally proposed by Ames (2001), but adapted to the subdivisions of each city, was generated for the sake of stressing the specificities of each electoral connection configuration.

In short, two dimensions of concentration of votes were measured for the elected representatives for the local legislative house in the last three elections (2016, 2020 and 2024).

The vertical dimension was analyzed using the D indicator, as in Chapter 1, that captures a “dominance” aspect of concentration operationalized as the average percentage of votes of a given politician in each spatial unit, weighted by the percentage of the candidate’s total votes that each spatial unit contributes. In this sense, the higher the value of that variable, the more concentrated and prevalent tend to be the politician’s voting patterns in a few specific territories -- see Terron et al. [-@terron_ha_2012] for a detailed description.

The horizontal dimension was calculated using the G indicator, as in Chapter 1, that captures the actual distribution of votes in comparison with a proportional distribution based on the number of voters in each spatial unit. The higher the value, the more the politician’s voting patterns are disproportionally concentrated in a few specific territories -- see Avelino et al. [-@avelino_concentracao_2016] for a detailed description.

Finally, based on the average of each dimension of concentration for the elected representatives in each city and electoral year, it was built a fourfold classification for the purpose of presenting descriptive and inferential findings -- dominant-concentrated; dominant-scattered; shared-concentrated; and shared-scattered.

The data used in the task described above came from the Electoral Superior Court (TSE)^[Available in: https://dadosabertos.tse.jus.br/.] repository concerning the electoral outcomes of past elections in Brazil. Following Chapter 1, the spatial unit of analysis will be the census tract (*área de ponderação*) defined in the 2010 Brazilian Census by IBGE^[Available in: https://www.ibge.gov.br/geociencias/downloads-geociencias.html.]. However, for the sake of this tentative chapter, preliminary results will focus only on the case of São Paulo municipality, having the IBAs addressed to subcity halls (*subprefeituras*) as the unit of analysis. To regionalize those votes, initially, the more than 2.000 polling stations in the municipality of São Paulo, in 2020, were geocoded to, later, through geoprocessing, identify which territory contained each zone-section (*zona-seção*) binomial accounting for the results. Lastly, the data concerning the record of IBAs allocated by city councilors in the municipality of São Paulo for the last years (2017-2024) was downloaded from the *Casa Civil* website of the City Hall of São Paulo^[Available in: https://capital.sp.gov.br/web/casa_civil/w/coordenadoria_de_acoes_municipais/345659.]. Multinomial logistic regression models were used to test the hypotheses^[All codes used in this research dissertation are available in: https://github.com/lucascividanes/PhD-s-Dissertation-R-Scripts.].

## Preliminary results

```{r setup2, include = FALSE}
library(tidyverse)
library(tidyverse)
library(sjPlot)
library(sf)
library(classInt)
library(nnet)
library(janitor)
library(knitr)
library(stargazer)

set_theme(theme_minimal())

indicators <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/indicators.csv", 
                         delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                             grouping_mark = "."), trim_ws = TRUE) %>% 
  subset(NM_MUNICIPIO == "SÃO PAULO")

profile <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/profile.csv", 
                         delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                             grouping_mark = "."), trim_ws = TRUE) %>% 
  subset(NM_MUNICIPIO == "SÃO PAULO") %>% 
  select(ANO_ELEICAO, NR_VOTAVEL, NM_URNA_CANDIDATO, DS_SIT_TOT_TURNO)

candidatos <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/margins.csv", 
                         delim = ";", escape_double = FALSE, 
                         locale = locale(decimal_mark = ",", grouping_mark = "."), 
                         trim_ws = TRUE) %>% 
  subset(NM_MUNICIPIO == "SÃO PAULO") %>% 
  select(ANO_ELEICAO, NR_CANDIDATO, NR_CPF_CANDIDATO)

indicators <- indicators %>%
  left_join(profile, by = c("ANO_ELEICAO", "NR_VOTAVEL")) %>%
  left_join(candidatos, by = c("ANO_ELEICAO", "NR_VOTAVEL" = "NR_CANDIDATO")) %>%
  select(ANO_ELEICAO, NM_URNA_CANDIDATO, D, G, QT_VOTOS_VER_TOTAL, PCT_VOTOS_VER_TOTAL, DS_SIT_TOT_TURNO, NR_CPF_CANDIDATO)
indicators$NM_URNA_CANDIDATO <- iconv(indicators$NM_URNA_CANDIDATO, from = 'UTF-8', to = 'ASCII//TRANSLIT')

class <- indicators %>% subset(DS_SIT_TOT_TURNO %in% c("ELEITO POR QP", "ELEITO POR MÉDIA"))

class$class <- NA

class$class[class$ANO_ELEICAO == 2016 &
            class$D > mean(class$D[class$ANO_ELEICAO == 2016], na.rm = T) &
            class$G > mean(class$G[class$ANO_ELEICAO == 2016], na.rm = T)] <- "DOMINANT-CONCENTRATED"
class$class[class$ANO_ELEICAO == 2016 &
            class$D <= mean(class$D[class$ANO_ELEICAO == 2016], na.rm = T) &
            class$G > mean(class$G[class$ANO_ELEICAO == 2016], na.rm = T)] <- "SHARED-CONCENTRATED"
class$class[class$ANO_ELEICAO == 2016 &
            class$D > mean(class$D[class$ANO_ELEICAO == 2016], na.rm = T) &
            class$G <= mean(class$G[class$ANO_ELEICAO == 2016], na.rm = T)] <- "DOMINANT-SCATTERED"
class$class[class$ANO_ELEICAO == 2016 &
            class$D <= mean(class$D[class$ANO_ELEICAO == 2016], na.rm = T) &
            class$G <= mean(class$G[class$ANO_ELEICAO == 2016], na.rm = T)] <- "SHARED-SCATTERED"

class$class[class$ANO_ELEICAO == 2020 &
            class$D > mean(class$D[class$ANO_ELEICAO == 2020], na.rm = T) &
            class$G > mean(class$G[class$ANO_ELEICAO == 2020], na.rm = T)] <- "DOMINANT-CONCENTRATED"
class$class[class$ANO_ELEICAO == 2020 &
            class$D <= mean(class$D[class$ANO_ELEICAO == 2020], na.rm = T) &
            class$G > mean(class$G[class$ANO_ELEICAO == 2020], na.rm = T)] <- "SHARED-CONCENTRATED"
class$class[class$ANO_ELEICAO == 2020 &
            class$D > mean(class$D[class$ANO_ELEICAO == 2020], na.rm = T) &
            class$G <= mean(class$G[class$ANO_ELEICAO == 2020], na.rm = T)] <- "DOMINANT-SCATTERED"
class$class[class$ANO_ELEICAO == 2020 &
            class$D <= mean(class$D[class$ANO_ELEICAO == 2020], na.rm = T) &
            class$G <= mean(class$G[class$ANO_ELEICAO == 2020], na.rm = T)] <- "SHARED-SCATTERED"

class <- class %>% select(ANO_ELEICAO, NM_URNA_CANDIDATO, class)

plot_grpfrq(class$class, class$ANO_ELEICAO,
         coord.flip = T, show.n = F, geom.colors = "gs")

iba_sp <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/iba_sp.csv", 
                     delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                         grouping_mark = "."), trim_ws = TRUE) %>% 
  left_join(indicators, by = c("election_year" = "ANO_ELEICAO", "councilor" = "NM_URNA_CANDIDATO"))

iba_sp <- iba_sp %>% left_join(class, by = c("election_year" = "ANO_ELEICAO", "councilor" = "NM_URNA_CANDIDATO"))

iba_sp %>% group_by(executor) %>% summarise(value = sum(value)) %>%
  mutate(pct = value/sum(value)) %>% arrange(-value)

iba_sp %>% group_by(sub) %>% summarise(value = sum(value)) %>%
  mutate(pct = value/sum(value))
```

### The use of IBAs in the municipality of São Paulo

The first part of the empirical contribution of this study is a descriptive one and aims at shedding light over the use(s) of IBAs in a large municipality in Brazil. So far, little is known about how city councilors employ the resources under their discretion, but a few numbers illustrate why it shouldn’t be neglected by students of urban politics, especially in large cities.

First, the volume of resources those city councilors have affluence over, in a municipality like São Paulo, is comparable to their federal and state legislative counterparts, as already discussed.

Second, the smaller number of representatives in the local legislative house facilitates the coordination of those actors [@olson_logic_2003]. For instance, if, in the Congress, the greater marginality of the ordinary federal deputy induces a prioritization of committee and collective budget amendments over the individual ones [@limongi_processo_2005], the same do not hold true for the local legislative house where IBAs compose circa 90% of the legislators’ interventions on the budget in a municipality like São Paulo [@gomes_role_2020]. Therefore, not only they are better able to “steer” that money, but also, they can focus their attention to a much more restricted constituency and geographic area.

Finally, the already compromising fiscal situation of municipalities -- discretionary funds are limited to around 20% of the total budget in a municipality like São Paulo according to Peres [-@marques_alise_2018] -- makes the IBAs even more useful instruments to interfere on the allocation of benefits in the city. For instance, the total amount of money mobilized through IBAs in São Paulo was, in 2020, equivalent to the budget of departments like Sports and Leisure or Green and Environment, the double of the previewed value for Assistance and Social Development or Innovation and Technology, and about a half of the resources directed to Housing or Culture every year -- again, in great part already constrained by mandatory expenses.

What are the use(s) of IBAs in the municipality of São Paulo? Looking at the *Casa Civil* records, from 2017 to 2024, 8.646 IBAs were directed to the executive departments considering elected city councilors (and eventual substitutes) in 2016 and 2020. The total amount of money sums up to R$1,4 billion, being the departments of Sports and Leisure; Culture; and Health, the most solicited secretaries (concentrating 22%, 21% and 15% of that total amount of money respectively) in the period. Other 23% were directed to one of the 32 regionalized subcity halls (hereafter, SCH) of the city with Capela do Socorro, for instance, ranking first (receiving about 2% of that total amount). Together those departments composed the big picture (81%) of the IBAs portfolio in that period.

Using a classification proposed by Marques [-@marques_rede_2018], I have grouped the IBAs in four categories according to the secretaries responsible for their execution: political; urban; social; and others^[For the sake of this analysis: political (*Casa Civil*; Government; and Institutional Relations); urban (Housing, Mobility and Transportation, Urban Infrastructure and Public Works, and Subcity Halls -- central secretary and regionals); social (Assistance and Social Development, Culture, Education, Handicapped Person, Health, Human Rights and Citizenship, Policies for Women, Racial Equality Promotion, and Sports and Leisure); and other (Green and Environment, Innovation and Technology, Economic Development and Labor, Tourism, and Urban Security).]. Again, for that same period, social departments concentrated 65% of the total amount of money followed by the urban ones with 25% and, finally, the political and others with 8% and 3%, respectively (see Figure \ref{fig:policy}). In short, departments closer to street-level policy implementation tended to be favored by local legislators.

```{r policy, fig.cap = "The use of IBAs by secretaries' categories (2017-2024). Source: author. Data: São Paulo City Hall.", warning = FALSE, echo = FALSE, fig.show='hold', out.width="75%", fig.align='center', fig.align='center'}
plot_frq(iba_sp$policy, weight.by = iba_sp$value,
         coord.flip = T, show.n = F, sort.frq = c("asc"))
```

Moreover, taking advantage of the natural regionalization provided by the not negligible number of IBAs directed to subcity halls -- unfortunately, *Casa Civil* records still don’t permit the regionalization of all IBAs of the period, but LAI requests will fulfill this gap in further explorations --, one can see in Figure \ref{fig:region}, Figure \ref{fig:votes_map} and Figure \ref{fig:ibas_map} that, following more or less the demographic distribution of valid votes in the city, the southern and the eastern regions of the city are the most targeted ones by the local politicians -- mostly at the expense of the central region.

```{r region, fig.cap = "The use of IBAs by São Paulo's five administrative regions (2017-2024). Source: author. Data: São Paulo City Hall.", warning = FALSE, echo = FALSE, fig.show='hold', out.width="75%", fig.align='center'}
plot_frq(iba_sp$region_5, weight.by = iba_sp$value,
         coord.flip = T, show.n = F, sort.frq = c("asc"))
```

```{r votes_map, fig.cap = "Number of valid votes over the 32-subcity halls of São Paulo. Source: author. Data: TSE.", warning = FALSE, echo = FALSE, fig.show='hold', out.width="75%", fig.align='center'}
votes_ter <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/ql_councilor_sp.csv", 
                              delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                                  grouping_mark = "."), trim_ws = TRUE) %>%
  distinct(ANO_ELEICAO, sp_nome, QT_VOTOS_TER)

shape <- read_sf(str_c("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/01_in/shapefiles/SIRGAS_SHP_subprefeitura_polygon.shp")) %>% 
  st_transform(31983) %>% 
  st_make_valid() %>% 
  mutate(sp_nome = str_c("SUBPREFEITURA ", sp_nome)) %>% 
  left_join(votes_ter, by = c("sp_nome"))

ggplot(shape) + 
  geom_sf(aes(fill = QT_VOTOS_TER), size = 0) +
  scale_fill_gradient(low = "white", high = "darkred") +
  labs(title = "", 
       subtitle = "",
       caption = "",
       fill = "Valid Votes",
       x = "", y = "") +
  #facet_grid(~TYPO) +
  facet_grid(~ANO_ELEICAO) +
  theme_void()
```

```{r ibas_map, fig.cap = "IBAs resources distribution over the 32-subcity halls of São Paulo. Source: author. Data: São Paulo City Hall.", warning = FALSE, echo = FALSE, fig.show='hold', out.width="75%", fig.align='center'}
aux_sp <- iba_sp %>% subset(sub == 1) %>% group_by(executor, election_year) %>% summarise(value = sum(value))

shape <- read_sf(str_c("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/01_in/shapefiles/SIRGAS_SHP_subprefeitura_polygon.shp")) %>% 
  st_transform(31983) %>% 
  st_make_valid() %>% 
  mutate(sp_nome = str_c("SUBPREFEITURA ", sp_nome)) %>% 
  left_join(aux_sp, by = c("sp_nome" = "executor"))

ggplot(shape) + 
  geom_sf(aes(fill = value), size = 0) +
  scale_fill_gradient(low = "white", high = "darkred") +
  labs(title = "", 
       subtitle = "",
       caption = "",
       fill = "IBAs resources",
       x = "", y = "") +
  #facet_grid(~TYPO) +
  facet_grid(~election_year) +
  theme_void()
```

Those first descriptive results led to the confirmation of a few expectations already acknowledged by the literature. For instance, it supported previous findings that legislators tend to be especially attentive to social policy sectors [@amorim_neto_o_2003; @silva_o_2011]. However, the relevance of the urban category and the disproportional targeting of specific regions of the city give indications that other phenomena may be at work simultaneously. Next, I will try to understand how the use(s) of IBAs varies according to the different configurations of electoral connection.

In this sense, a first exploration I propose is to check how the distribution of the LQ indicator varies among the different classifications of legislators. Figure \ref{fig:typo_map} shows how the southern region of the city is especially important for the election of legislators with dominant patterns of vote -- especially to the concentrated ones, with the southern region also playing an important role for their scattered peers. The shared-scattered pattern, in turn, is much more widespread in all the municipality territory. Finally, with the shared-concentrated being particularly relevant in the (wealthier) western region of the city.

```{r typo_map, fig.cap = "Locational quotient (LQ) per classification of legislators' electoral connection. Source: author. Data: TSE.", warning = FALSE, echo = FALSE, fig.show='hold', out.width="75%", fig.align='center', fig.width = 10, fig.height = 16}
ql_typo_sp <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/ql_typo_sp.csv", 
                         delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                             grouping_mark = "."), trim_ws = TRUE) %>% 
  mutate(CD_APONDE = as.character(CD_APONDE))

ano <- "2016"
mun <- "SÃO PAULO"

shape <- read_sf(str_c("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/01_in/shapefiles/", iconv(mun, from = 'UTF-8', to = 'ASCII//TRANSLIT'), "_area_de_ponderacao.shp")) %>%
  st_transform(31983) %>% 
  rename(any_of(c("CD_APONDE" = "CD_APonde"))) %>% 
  st_make_valid() %>% 
  #left_join(select(subset(ql_typo_sp, ANO_ELEICAO == ano), TYPO, CD_APONDE, QL), by = "CD_APONDE") %>% 
  left_join(select(ql_typo_sp, ANO_ELEICAO, TYPO, CD_APONDE, QL), by = "CD_APONDE") %>% 
  subset(!is.na(TYPO))

ggplot(shape) + 
  geom_sf(aes(fill = QL), size = 0, color = NA) +
  scale_fill_gradient(low = "white", high = "darkred") +
  labs(title = "", 
       subtitle = "",
       caption = "",
       fill = "QL",
       x = "", y = "") +
  #facet_grid(~TYPO) +
  facet_grid(TYPO ~ ANO_ELEICAO, switch = "y") +
  theme_void() +
  theme(strip.text.y.left = element_text(angle = 90))
```

What those different configurations can tell us about the use(s) of IBAs in São Paulo? Looking at the IBAs targeting through the classification prism, a significative difference following the vertical dimension of concentration -- dominance -- becomes again clear in the voting patterns in São Paulo. Figure \ref{fig:typo_s} highlights how dominant city councilors tend to address more IBAs to urban departments (circa 30 to 40% of their total volume of resources), while shared ones concentrate IBAs with more often in the social category (about 60% to 70% in this case).

```{r typo_s, fig.cap = "The use of IBAs by secretaries categories per classification of legislators' electoral connection (2017-2024). Source: author. Data: São Paulo City Hall and TSE.", warning = FALSE, echo = FALSE, fig.show='hold', out.width="75%", fig.align='center', fig.width = 10}
plot_xtab(iba_sp$class, iba_sp$policy, weight.by = iba_sp$value,
          margin = "row", bar.pos = "stack",
          show.summary = TRUE, coord.flip = TRUE,
          show.prc = T, show.n = F)
```

Another interesting aspect is highlighted in Figure \ref{fig:typo_sub}. It is possible to note a significant difference over the regions that the different classifications of legislators tend to direct resources via SCHs. In line with the spatial phenomenon just described above, the southern region is, as expected, more targeted by dominant city councilors, while the eastern one tends to be attended by all classifications except by the shared-concentrated ones. Wealthier spaces, in turn, more concentrated on the western and central regions of the city, become more relevant only to the shared-scattered local politicians.

```{r typo_sub, fig.cap = "The use of IBAs by subcity halls categories per classification of legislators' electoral connection (2017-2024). Source: author. Data: São Paulo City Hall and TSE.", warning = FALSE, echo = FALSE, fig.show='hold', out.width="75%", fig.align='center', fig.width = 10}

aux_iba_sp <- iba_sp %>% subset(sub == 1)
  
plot_xtab(iba_sp$class, iba_sp$region_5, weight.by = iba_sp$value,
          margin = "row", bar.pos = "stack",
          show.summary = TRUE, coord.flip = TRUE,
          show.prc = T, show.n = F)
```

What are the consequences of the first inferential results concerning the multiple configurations of the electoral connection of local legislators described above? Those findings corroborate with past contributions that put emphasis on distinct voting behaviors following the socioeconomic segregation typical of large urban agglomerations in Brazil [@kuschnir_eleicoes_2000]. If the richer tend to vote “ideologically”, the poorer seems especially leaned to support local leaderships in a more “territorial” fashion. In response, politicians do seem to constrain their behavior following their spatial voting patterns in the use(s) of IBAs. Nevertheless, different dimensions of concentration can be observed even among the poorest. The east-south divide suggests that other dynamics, like the territorial bargaining for coalition building [@grin_executivo_2012], may also influence how those logics operate. In this sense, the southern region is a key piece of that puzzle as both dimensions of concentration are observable there. To test what are the determinants of the use(s) of IBAs will be my next topic.

### Determinants of the use of IBAs as a pork-barrel mechanism

What are the determinants of the use(s) of IBAs? I will draw next a multinomial logistic regression to test the influence of the spatial patterns of electoral outcomes on the use of those resources. First, I plot how the volume of resources is correlated with the LQ of each city councilor in a given spatial unit. Figure \ref{fig:corr} shows a positive relationship especially for those with higher concentration metrics.

```{r corr, fig.cap = "City councilors' IBAs targeting per Locational quotient (LQ) (2017-2024). Source: author. Data: São Paulo City Hall and TSE.", warning = FALSE, echo = FALSE, fig.show='hold', out.width="75%", fig.align='center', }
ql_councilor_sp <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/ql_councilor_sp.csv", 
                         delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                             grouping_mark = "."), trim_ws = TRUE) #%>% 
  #mutate(NM_URNA_CANDIDATO = iconv(NM_URNA_CANDIDATO, from = 'UTF-8', to = 'ASCII//TRANSLIT'))


iba_sp_sub <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/iba_sp.csv", 
                     delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                         grouping_mark = "."), trim_ws = TRUE) %>% 
  subset(sub == 1)

iba_sp_sub <- iba_sp_sub %>% 
  left_join(select(ql_councilor_sp, ANO_ELEICAO, NM_URNA_CANDIDATO, sp_nome, QL), by = c("election_year" = "ANO_ELEICAO", "councilor" = "NM_URNA_CANDIDATO", "executor" = "sp_nome")) %>% 
  left_join(distinct(indicators, ANO_ELEICAO, NM_URNA_CANDIDATO, NR_CPF_CANDIDATO), by = c("election_year" = "ANO_ELEICAO", "councilor" = "NM_URNA_CANDIDATO"))

iba_sp_sub %>% 
  group_by(councilor, QL) %>% 
  summarise(value = sum(value, na.rm = T)) %>% 
  ggplot(aes(x = QL, y = value)) +
  geom_point() +
  geom_smooth(method = "lm")
```

Moreover, I propose a model that tests if the concentration of voting patterns do incentive different strategies of IBAs’ targeting. The aim of my assessment is to estimate the likelihood of a local politician relying on the contingent and noncontingent functions of the use(s) of IBAs, having as the main independent variable the LQ of each city councilor in a given spatial unit. Higher levels of concentration might induce an overreliance on the contingent function, since it may overcome the challenges, originally suggested by Lancaster [-@lancaster_electoral_1986], of clarity in terms of credit claiming. In turn, smaller levels of concentration may push for a preference on the use of IBAs in a nonterritorial logic, or, in a context of a given spatial unit with higher levels of competition, a strategic noncontingent use to convert swing voters.

Socioeconomic and demographic characteristics of a territory are also expected to play a role since vulnerability tends to push for nonprogrammatic politics and, hence, IBAs’ targeting-- whether contingent or noncontingent in opposition to nonterritorial. The underlying assumption derives from Stokes’ [-@boix_political_2009, p. 650] reasoning over clientelism where “all else equal we would expect patron-client ties to be prevalent in societies with widespread poverty and with a relatively weak and ineffective state apparatus”. The operationalization of such indicator took as a proxy the IDH-M^[Municipal Human Development Index (*Índice de Desenvolvimento Humano Municipal*) available in: http://dados.prefeitura.sp.gov.br/dataset/indice-de-desenvolvimento-humano-municipal.] calculated for the year of 2010 in each SCH in São Paulo. The bigger the index, the smaller the likelihood of IBAs targeting are expected to be.

Politician’s electoral insecurity also tend to influence the more or less attention dispended by the legislator to the constituency’s interests [@fenno_home_2003]. My expectation, in this case, is that the lower the rank of a politician in the electoral list and the bigger the fragmentation of votes in a given spatial unit, the higher will be the reliance on IBAs’ targeting due to their need to secure their electorates. The rank variable was operationalized using a “smoothed” version of frequency-based estimates known as the Laplace’s correction (i.e., one minus the candidate’s position in the electoral list plus one divided by the number of elected representatives of that list plus two). Fragmentation was defined by the number of effective candidates (NEC) based on nominal votes in a given spatial unit (i.e., one divided by the sum of the squared share of votes of each candidate in that spatial unit).

To control  for different strategies of amendments’ distribution (some legislators concentrate resources in only a few, others divided in a larger number), I’ve included a variable with the total number of amendments proposed by each city councilor in the period analyzed and, since different numbers of spatial units were considered as part of their electoral territory, another variable was added to the model taking that value in consideration. Finally, the model was generated with the IBAs of the 2017-2020 period, having the nonterritorial category as reference. Table 2.1 summarizes the results of the multinomial logistic regression.

```{r model_aux, include = FALSE}

lisa_councilor_sp <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/lisa_councilor_sp.csv", 
                              delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                                  grouping_mark = "."), trim_ws = TRUE) %>% 
  left_join(distinct(indicators, ANO_ELEICAO, NM_URNA_CANDIDATO, NR_CPF_CANDIDATO), by = c("ANO_ELEICAO", "NM_URNA_CANDIDATO"))

iba_sp_sub <- iba_sp_sub %>%
  subset(election_year == 2016) %>% 
  mutate(election_year_t_4 = election_year + 4) %>%
  left_join(select(lisa_councilor_sp, NR_CPF_CANDIDATO, sp_nome, ANO_ELEICAO, SD, LISA), by = c("NR_CPF_CANDIDATO", "executor" = "sp_nome", "election_year" = "ANO_ELEICAO")) %>% 
  left_join(select(lisa_councilor_sp, NR_CPF_CANDIDATO, sp_nome, ANO_ELEICAO, SD, LISA), by = c("NR_CPF_CANDIDATO", "executor" = "sp_nome", "election_year_t_4" = "ANO_ELEICAO"))

# teste <- nrow(iba_sp_sub)
# iba_sp_sub <- na.omit(iba_sp_sub)
# print(nrow(iba_sp_sub) / teste)

iba_sp_sub$iba_use <- "Nonterritorial"
iba_sp_sub$iba_use[iba_sp_sub$LISA.x %in% c("Alto-Alto", "Alto-Baixo") | iba_sp_sub$SD.x >= 5] <- "Contingent"
iba_sp_sub$iba_use[iba_sp_sub$iba_use == "Nonterritorial" & (iba_sp_sub$LISA.y %in% c("Alto-Alto", "Alto-Baixo") | iba_sp_sub$SD.y >= 5)] <- "Noncontingent"

# plot_frq(iba_sp_sub$iba_use)

iba_sp_sub$iba_use <- factor(iba_sp_sub$iba_use, levels = c("Nonterritorial", "Noncontingent", "Contingent"))

nec_sp <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/nec_sp.csv", 
                     delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                                                                                                  grouping_mark = "."), trim_ws = TRUE)
idhm <- read_csv("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/01_in/geosampa/DEINFO_IDH_UDH_2000_2010_Dados.csv", 
                 locale = locale(encoding = "latin1")) %>% 
  clean_names() %>% 
  group_by(prefreg) %>% 
  summarise(median_idhm = median(idhm, na.rm  = T)) %>% 
  mutate(prefreg = str_replace_all(str_to_upper(str_c("SUBPREFEITURA ", prefreg)), "/", "-"))
idhm$prefreg <- iconv(idhm$prefreg, from = 'UTF-8', to = 'ASCII//TRANSLIT')

ter <- lisa_councilor_sp %>% 
  group_by(ANO_ELEICAO, NM_URNA_CANDIDATO) %>% 
  summarise(N_TER = sum(LISA %in% c("Alto-Alto", "Alto-Baixo") | SD >= 5, na.rm = T))

rank <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/indicators.csv", 
                         delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                             grouping_mark = "."), trim_ws = TRUE) %>% 
  subset(NM_MUNICIPIO == "SÃO PAULO")

candidatos <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/margins.csv", 
                         delim = ";", escape_double = FALSE, 
                         locale = locale(decimal_mark = ",", grouping_mark = "."), 
                         trim_ws = TRUE) %>% 
  subset(NM_MUNICIPIO == "SÃO PAULO") %>% 
  select(ANO_ELEICAO, NR_CANDIDATO, DS_COMPOSICAO_COLIGACAO, DS_SIT_TOT_TURNO)

profile <- read_delim("G:/Meu Drive/Acadêmicos/Doutorado/PhD-s-Dissertation-R-Scripts/02_out/profile.csv", 
                      delim = ";", escape_double = FALSE, locale = locale(decimal_mark = ",", 
                                                                          grouping_mark = "."), trim_ws = TRUE) %>% 
  subset(NM_MUNICIPIO == "SÃO PAULO") %>% 
  select(ANO_ELEICAO, NR_VOTAVEL, NM_URNA_CANDIDATO)

rank <- rank %>%
  left_join(candidatos, by = c("ANO_ELEICAO", "NR_VOTAVEL" = "NR_CANDIDATO")) %>% 
  left_join(profile, by = c("ANO_ELEICAO", "NR_VOTAVEL")) %>%
  arrange(ANO_ELEICAO, DS_COMPOSICAO_COLIGACAO, -PCT_VOTOS_VER_TOTAL) %>% 
  group_by(ANO_ELEICAO, DS_COMPOSICAO_COLIGACAO) %>% 
  mutate(RANK = rank(-PCT_VOTOS_VER_TOTAL)) %>% 
  ungroup() %>% 
  group_by(ANO_ELEICAO, DS_COMPOSICAO_COLIGACAO) %>% 
  mutate(LIST = max(RANK[DS_SIT_TOT_TURNO %in% c("ELEITO POR MÉDIA", "ELEITO POR QP")]),
         LIST = case_when(is.infinite(LIST) ~ NA,
                          TRUE ~ LIST)) %>%
  ungroup() %>% 
  mutate(RANK = ((RANK + 1) / (LIST + 2))) %>% 
  select(ANO_ELEICAO, NM_URNA_CANDIDATO, RANK)
  
iba_sp_sub <- iba_sp_sub %>%
  left_join(nec_sp, by = c("election_year" = "ANO_ELEICAO", "executor" = "sp_nome")) %>%
  left_join(ter, by = c("election_year" = "ANO_ELEICAO", "councilor" = "NM_URNA_CANDIDATO")) %>% 
  left_join(idhm, by = c("executor" = "prefreg")) %>%
  left_join(rank, by = c("election_year" = "ANO_ELEICAO", "councilor" = "NM_URNA_CANDIDATO")) %>% 
  group_by(councilor) %>% mutate(N_IBA = n()) %>% ungroup()

model <- multinom(iba_use ~ QL + NEC + RANK + median_idhm + N_IBA + N_TER, data = iba_sp_sub)
```

```{r model, results="asis", warning = FALSE, echo = FALSE}
stargazer(model, style = "ajps", title = "Multinomial logistic regression of the use(s) of IBAs. Source: author. Data: São Paulo City Hall and TSE.", omit.stat = "f", header = F, type = "latex")
```

As shown in Figure \ref{fig:prob}, the interpretation suggests that the contingent use of IBAs tend to be the most common function fulfilled by that instrument in the municipality of São Paulo. Yet, if, in general, almost 60% of IBAs tended to be targeted in that fashion for the whole period, the levels of concentration in a given territory do play a relevant role to increase that probability. All else constant in its median values, one point increase in LQ median metrics leads to almost 30% higher odds of the contingent type of use. Mostly interesting, intermediary values of LQ favor the noncontingent use of IBAs (comprising circa 10% of the recorded uses), with smaller values pushing for the nonterritorial alternative (corresponding to about 30% of the total uses). In turn, the number of IBAs and the number of electoral territories also favors an overreliance on the contingent use of IBAs and diminishes the noncontingent function, in comparison with nonterritorial targeting. Surprisingly, political insecurity tends to reduce the contingent use of IBAs.

```{r prob, fig.cap = "Predicted probabilities for each function of IBAs targeting (2017-2020). Source: author. Data: São Paulo City Hall and TSE.", warning = FALSE, echo = FALSE, fig.show='hold', out.width="75%", fig.align='center', message = FALSE, comment = NA}

plot_model(model, type = "pred", terms = "QL [all]")
```

## Discussion

This chapter aimed at shedding light over the use(s) of IBAs in large municipalities in Brazil and at stressing the repertoire of functions such an instrument may fulfill (*H1*). Findings show that, despite a certain negligence of the literature, the relationship between local legislators’ discretionary funds and urban politics seems to be a promising research agenda. It has been shown that not only the socioeconomic segregation lines dividing many large urban agglomerations in Brazil tend to exacerbate the targeting of more vulnerable territories with IBAs (*H1b*), especially in urban and social policy sectors, but also that the multiple configurations of electoral connection of city councilors, following an electoral connection reasoning, push for a bigger or smaller likelihood to rely on IBAs in the contingent and noncontingent functions (*H1a*). 

Future explorations might enrich the database used so far and also try to take a comparative perspective considering other large municipalities in that country to look for generalizations concerning the functions highlighted here. Opportunities to rely on natural experiments and synthetic control design based on the different timing of adoption of that instrument in each municipality are also being studied.